# システムの起動

## システムの起動をカスタマイズする

### systemd
- 処理単位であるユニット
- ユニットの集合体であるターゲット
- OSに関わる操作も実施

#### target
- `poweroff.target` ランレベル0に相当
- `rescue.target` ランレベル1に相当
- `multi-user.target` ランレベル2-4に相当
- `graphical.target` ランレベル5に相当
- `reboot.target` ランレベル6に相当
- `default.target` シンボリックリンクファイルを示すファイルであり、`/etc/systemd/system`に配置

#### /usr/lib/systemd/system
- 永続的なユニット、ターゲットの定義ファイルを配置

#### /etc/systemd/system
- カスタム用のディレクトリ
- 優先度が高い

#### /run/systemd/system
- 再起動すると削除されるディレクトリ
- `/usr/lib`より優先度が高い

#### systemctl
- `get-default` デフォルトターゲットの名前を表示
- `poweroff` 電源OFF
- `emergency` 緊急モードに移行
- `rescue` レスキューモードに移行
- `default` 標準のモードに移行
- `reboot` 再起動
- `isolate multi-user.target` multi-userターゲット以外のユニット、ターゲットを停止し、multi-userターゲットを実行
	- SysVinitにおけるランレベルの変更

### SysVinit
#### initプロセス
- カーネルにより起動される特殊なプロセス
- PIDが1(固定)
- `/etc/inittab`を読み込み、ランレベルを確認
- ランレベル毎の処理を実施

#### /etc/rc[0-6].d
- `S85httpd`
	- S 起動
	- 85 実行順序(昇順)
	- httpd サービス名

#### /etc/init.d
- 起動スクリプトの実体が配置されている

#### telinit
- initプロセスに指示を出し、ランレベルを変更することができるコマンド
- `init`コマンドと同様の使い方ができる
- 管理権限を持ったスーパーユーザでしか利用出来ない
- システムを再起動させることができる

#### /etc/inittab
- `l0:0:wait:/etc/rd.d/rc 0`
	- l0 ID
	- 0 ランレベル
	- wait アクション指示子 プロセスが終了するまで次の処理を行わない
	- /etc/rd.d/rc 0 処理
